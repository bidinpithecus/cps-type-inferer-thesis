% \chapter{Sistema Damas Milner}\label{ch:damas-milner}

% O sistema Damas-Milner é um sistema de tipos para o cálculo lamda, com polimorfismo paramétrico criado por Hindley, Damas e Milner para a linguagem de programação de propósito geral ML \cite{HINDLEY1969, MILNER1978, DAMAS1984}.
% Conforme destacado por \citeonline{DAMAS1982}, a linguagem ML possuia fortes aspectos como flexibilidade (através do polimorfismo), robustez (devido à \textit{soundness} semântica) e fortes mecanismos de detecção de erros em tempo de compilação.
% Este equilíbrio, permite que linguagens funcionais como Haskell e OCaml herdem suas características e usem este sistema como base em seus sistemas de tipos.

% \section{Algoritmo W}\label{sec:w-algo}

\chapter{Sistema Damas-Milner}\label{ch:damas-milner}

O sistema Damas-Milner, introduzido por Robin Milner e posteriormente formalizado em maior detalhe por Luis Damas \cite{MILNER1978, DAMAS1982}, é um dos sistemas de tipos mais influentes para linguagens funcionais.
Este sistema tem como principal característica a inferência automática de tipos polimórficos, sem a necessidade de anotações explícitas por parte do programador, como ocorre em linguagens como ML, Haskell e OCaml.
A sua base é o cálculo lambda com polimorfismo paramétrico, permitindo que funções possam operar sobre múltiplos tipos de maneira genérica.

A introdução do sistema Damas-Milner trouxe duas contribuições principais: a definição de um sistema de tipos que é robusto, garantindo propriedades como \textit{soundness} (consistência semântica), e a criação de um algoritmo, o Algoritmo W, capaz de inferir o tipo mais geral (também chamado de \textit{principal type-scheme}), conforme demonstrado em \citeonline{DAMAS1984}.
Como resultado, a linguagem ML e suas derivadas se tornaram notórias por fornecer ao programador a capacidade de escrever programas sem erros de tipo detectáveis durante a compilação, permitindo um desenvolvimento mais seguro e robusto \cite{MILNER1978, DAMAS1984}.

A sintaxe do sistema DM define as expressões e os tipos usados no processo de inferência.
Abaixo, segue a gramática das expressões e tipos:

\begin{equation}\label{eq:dm-syntax}
  \begin{array}{ll}
    \text{Variáveis}         & x                                                                                 \\
    \text{Expressões}        & e ::= x \mid e \ e' \mid \lambda x.e \mid \texttt{let} \ x = e \ \texttt{in} \ e' \\
    \\
    \text{Variáveis de tipo} & \alpha                                                                            \\
    \text{Tipos primitivos}  & \iota                                                                             \\
    \text{Tipos}             & \tau ::= \alpha \mid \iota \mid \tau \rightarrow \tau
    \alpha                                                                                                       \\
    \text{Schemes}           & \sigma ::= \forall \alpha. \sigma \mid \tau                                       \\
  \end{array}
\end{equation}

Na sintaxe, $x$ representa variáveis que podem ser nomes de qualquer identificador, e $e$ descreve expressões que podem ser variáveis, aplicações de função, funções anônimas ou declarações \texttt{let}, que introduzem polimorfismo através de generalização de tipos.
As variáveis de tipo $\alpha$ são usadas para representar tipos genéricos.
Os tipos primitivos $\iota$ são usados para representar tipos constantes.
Tipos $\tau$ podem ser tanto variáveis de tipo quanto funções entre tipos.
Por fim, $\sigma$ denota \textit{schemes}, ou tipos polimórficos, que podem quantificar variáveis de tipo, permitindo reutilização de tipos genéricos em diferentes contextos.

O polimorfismo no sistema Damas-Milner é introduzido pelas expressões \texttt{let}, que permitem a generalização de tipos. Ao declarar uma variável ou função usando \texttt{let}, o tipo inferido é generalizado para ser reutilizado em diferentes contextos. Isso significa que, ao declarar uma função como $\texttt{id} = \lambda x.x$, o sistema deduz o tipo mais geral $\forall \alpha. \alpha \rightarrow \alpha$, que pode ser usado com diferentes tipos conforme necessário.

A inferência de tipos envolve dois processos principais: generalização e instanciação.
A generalização ocorre quando o sistema identifica que uma expressão pode ser tipada com um tipo mais geral, permitindo que seja reutilizada de maneira polimórfica.
Já a instanciação ocorre quando um tipo polimórfico é aplicado a um tipo concreto, especializando-o para um uso específico.
Esse mecanismo garante a flexibilidade do sistema, ao mesmo tempo que mantém a segurança garantida pela inferência de tipos.

Por exemplo, considere a expressão $\texttt{let id} \ = \lambda x.x \ \texttt{in} \ (\texttt{id} \ \texttt{1}, \ \texttt{id} \ \texttt{`a'})$.
O sistema generaliza o tipo de $\texttt{id}$ para $\forall \alpha. \alpha \rightarrow \alpha$, e instancia este tipo tanto para inteiros quanto para caracteres nas duas aplicações subsequentes.

% Substituições

% Variáveis livres

% Regras de inferência

\section{Algoritmo W}\label{sec:w-algo}

% Algoritmo de unificação

% Algoritmo W
